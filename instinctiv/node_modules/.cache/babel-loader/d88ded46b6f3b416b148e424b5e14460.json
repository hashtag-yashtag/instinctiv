{"ast":null,"code":"import _classCallCheck from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/yash/instinctiv/instinctiv/src/components/Notifications/index.js\";\nimport React, { Component } from 'react';\nimport { UncontrolledDropdown, DropdownToggle, DropdownMenu } from \"reactstrap\";\nimport { withAuthorization } from '../Session';\n\nvar Notifications =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Notifications, _Component);\n\n  function Notifications(props) {\n    var _this;\n\n    _classCallCheck(this, Notifications);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Notifications).call(this, props));\n    _this.toggle = _this.toggle.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.state = {\n      dropdownOpen: false\n    };\n    return _this;\n  }\n\n  _createClass(Notifications, [{\n    key: \"toggle\",\n    value: function toggle() {\n      this.setState(function (prevState) {\n        return {\n          dropdownOpen: !prevState.dropdownOpen\n        };\n      });\n    }\n  }, {\n    key: \"renderNotifs\",\n    value: function renderNotifs(notif, id) {\n      var _this2 = this;\n\n      var row = document.createElement('DropdownItem');\n      row.setAttribute('id', id);\n      var delBut = document.createElement('button');\n      delBut.addEventListener('click', function (e) {\n        e.stopPropagation();\n        console.log(e.target.parentElement.getAttribute('id'));\n\n        _this2.props.firebase.db.collection(\"Users\").doc(_this2.props.firebase.auth.O).collection(\"notifications\").doc(e.target.parentElement.getAttribute('id')).update({\n          active: false\n        });\n\n        document.getElementById(\"menu\").innerHTML = \"\";\n      });\n      delBut.textContent = 'X'; //del.appendChild(delBut);\n\n      row.appendChild(delBut);\n      row.append(notif.data().message);\n      document.getElementById(\"menu\").appendChild(row);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"notifications\").where('active', '==', true).onSnapshot(function (querySnapshot) {\n        console.log(\"Received query snapshot of size \".concat(querySnapshot.size));\n        querySnapshot.forEach(function (element) {\n          _this3.renderNotifs(element, element.id); //element.data().id = element.id;\n\n        });\n      }, function (err) {\n        console.log(\"Encountered error: \".concat(err));\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(UncontrolledDropdown, {\n        nav: true,\n        inNavbar: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, React.createElement(DropdownToggle, {\n        nav: true,\n        caret: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, \"Notifications\"), React.createElement(DropdownMenu, {\n        right: true,\n        id: \"menu\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, \"Notifications\"));\n    }\n  }]);\n\n  return Notifications;\n}(Component);\n\nvar condition = function condition(authUser) {\n  return !!authUser;\n};\n\nexport default withAuthorization(condition)(Notifications);\n/* <Dropdown isOpen={this.state.dropdownOpen} toggle={this.toggle}>\n        <DropdownToggle caret>\n          Notifications\n        </DropdownToggle>\n        <DropdownMenu>\n          <ul id=\"list\"></ul>\n        </DropdownMenu>\n      </Dropdown> */","map":{"version":3,"sources":["/Users/yash/instinctiv/instinctiv/src/components/Notifications/index.js"],"names":["React","Component","UncontrolledDropdown","DropdownToggle","DropdownMenu","withAuthorization","Notifications","props","toggle","bind","state","dropdownOpen","setState","prevState","notif","id","row","document","createElement","setAttribute","delBut","addEventListener","e","stopPropagation","console","log","target","parentElement","getAttribute","firebase","db","collection","doc","auth","O","update","active","getElementById","innerHTML","textContent","appendChild","append","data","message","where","onSnapshot","querySnapshot","size","forEach","element","renderNotifs","err","condition","authUser"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n  UncontrolledDropdown,\n  DropdownToggle,\n  DropdownMenu\n} from \"reactstrap\";\nimport { withAuthorization } from '../Session';\n\n\n\nclass Notifications extends Component {\n  constructor(props) {\n    super(props);\n\n    this.toggle = this.toggle.bind(this);\n    this.state = {\n      dropdownOpen: false\n    }\n    \n  }\n\n\n\n  toggle() {\n    this.setState(prevState => ({\n      dropdownOpen: !prevState.dropdownOpen\n    }));\n  }\n\n  renderNotifs(notif, id){\n\n    var row = document.createElement('DropdownItem');\n    row.setAttribute('id', id);\n    var delBut = document.createElement('button');\n    delBut.addEventListener('click',(e)=>{\n      e.stopPropagation();\n      console.log(e.target.parentElement.getAttribute('id'));\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O)\n      .collection(\"notifications\").doc(e.target.parentElement.getAttribute('id')).update({\n        active: false,\n      });\n      document.getElementById(\"menu\").innerHTML = \"\";\n    });\n    delBut.textContent = 'X';\n    //del.appendChild(delBut);\n    row.appendChild(delBut);\n    row.append(notif.data().message);\n\n    document.getElementById(\"menu\").appendChild(row);\n  }\n  \n  componentDidMount() {\n    this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O)\n            .collection(\"notifications\")\n              .where('active', '==', true)\n              .onSnapshot(querySnapshot => {\n      console.log(`Received query snapshot of size ${querySnapshot.size}`);\n      querySnapshot.forEach(element => {\n        this.renderNotifs(element, element.id);\n        //element.data().id = element.id;\n      });\n    }, err => {\n      console.log(`Encountered error: ${err}`);\n    });\n  }\n\n  render() {\n    return (\n      <UncontrolledDropdown nav inNavbar>\n          <DropdownToggle nav caret>\n            Notifications\n          </DropdownToggle>\n          <DropdownMenu right id=\"menu\">\n            Notifications\n          </DropdownMenu>\n        </UncontrolledDropdown>\n    );\n  }\n}\n\nconst condition = authUser => !!authUser;\nexport default withAuthorization(condition)(Notifications);\n/* <Dropdown isOpen={this.state.dropdownOpen} toggle={this.toggle}>\n        <DropdownToggle caret>\n          Notifications\n        </DropdownToggle>\n        <DropdownMenu>\n          <ul id=\"list\"></ul>\n        </DropdownMenu>\n      </Dropdown> */\n"]},"metadata":{},"sourceType":"module"}