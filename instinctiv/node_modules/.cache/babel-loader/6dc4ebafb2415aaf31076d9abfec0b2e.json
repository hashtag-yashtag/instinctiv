{"ast":null,"code":"import _classCallCheck from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/yash/instinctiv/instinctiv/src/components/Stocks/index.js\";\nimport React, { Component } from \"react\";\nimport { AuthUserContext, withAuthorization } from '../Session';\nimport { Input, Button, Col, Row, Card, CardText, Alert } from 'reactstrap';\nimport './stocks.css';\nimport TradingViewWidget, { Themes } from 'react-tradingview-widget';\n\nvar Stocks =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Stocks, _Component);\n\n  function Stocks(props) {\n    var _this;\n\n    _classCallCheck(this, Stocks);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Stocks).call(this, props));\n    _this.state = {\n      username: '',\n      balance: '',\n      stock: _this.props.match.params.name //this.handleChange = this.handleChange.bind(this);\n      //this.handleSubmitStock = this.handleSubmitStock.bind(this);\n\n    };\n    return _this;\n  }\n\n  _createClass(Stocks, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).onSnapshot(function (docSnapshot) {\n        console.log(\"Received doc snapshot: docSnapshot\", docSnapshot.data());\n\n        _this2.setState({\n          balance: docSnapshot.data().balance,\n          username: docSnapshot.data().username,\n          stock: _this2.props.match.params.name\n        }); // ...\n\n      }, function (err) {\n        console.log(\"Encountered error: \".concat(err));\n      });\n      this.props.firebase.db.collection(\"Stocks\").doc(this.props.match.params.name).onSnapshot(function (docSnapshot) {\n        console.log(\"Received doc snapshot: docSnapshot\", docSnapshot.data());\n\n        _this2.setState({\n          balance: _this2.state.balance,\n          username: _this2.state.username,\n          address: docSnapshot.data().address,\n          ceo: docSnapshot.data().ceo,\n          companyURL: docSnapshot.data().companyURL,\n          description: docSnapshot.data().description,\n          employees: docSnapshot.data().employees,\n          name: docSnapshot.data().name,\n          price: docSnapshot.data().price,\n          stockExchange: docSnapshot.data().stockExchange,\n          ticker: docSnapshot.data().ticker,\n          time_updated: docSnapshot.data().time_updated\n        }); // ...\n\n      }, function (err) {\n        console.log(\"Encountered error: \".concat(err));\n      });\n      this.viewNews();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(AuthUserContext.Consumer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }, function (authUser) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 58\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"column small-centered small-11 medium-6 large-5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 59\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 60\n          },\n          __self: this\n        }, _this3.props.match.params.name), React.createElement(Card, {\n          body: true,\n          outline: true,\n          color: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 61\n          },\n          __self: this\n        }, React.createElement(CardText, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 62\n          },\n          __self: this\n        }, React.createElement(Alert, {\n          color: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 63\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        }, \"name: \", _this3.state.name)), React.createElement(Alert, {\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 67\n          },\n          __self: this\n        }, \"address: \", _this3.state.address)), React.createElement(Alert, {\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70\n          },\n          __self: this\n        }, \"ceo: \", _this3.state.ceo)), React.createElement(Alert, {\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73\n          },\n          __self: this\n        }, \"companyURL: \", _this3.state.companyURL)), React.createElement(Alert, {\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 76\n          },\n          __self: this\n        }, \"description: \", _this3.state.description)), React.createElement(Alert, {\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79\n          },\n          __self: this\n        }, \"employees: \", _this3.state.employees)), React.createElement(Alert, {\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 81\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82\n          },\n          __self: this\n        }, \"stockExchange: \", _this3.state.stockExchange)), React.createElement(Alert, {\n          color: \"warning\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, \"price: \", _this3.state.price)), React.createElement(Alert, {\n          color: \"success\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 87\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 88\n          },\n          __self: this\n        }, \"time_updated: \", _this3.state.time_updated)))), React.createElement(Row, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93\n          },\n          __self: this\n        }, React.createElement(Col, {\n          sm: \"6\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        }, React.createElement(Input, {\n          type: \"number\",\n          name: \"tokens\",\n          id: \"tokens\",\n          placeholder: \"Enter a amount to bet\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        })), React.createElement(Col, {\n          sm: \"2\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, React.createElement(Button, {\n          color: \"success\",\n          id: \"up\",\n          onClick: _this3.handleUp.bind(_this3),\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, \" Up \")), React.createElement(Col, {\n          sm: \"2\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, React.createElement(Button, {\n          color: \"secondary\",\n          id: \"down\",\n          onClick: _this3.handleDown.bind(_this3),\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101\n          },\n          __self: this\n        }, \" Down \"))), React.createElement(\"h3\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }, \"You currently have\"), React.createElement(\"span\", {\n          className: _this3.getBadgeClasses(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, _this3.formatNumberOfTokensLeft()), React.createElement(\"h6\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, \" number of tokens.\")), React.createElement(\"div\", {\n          className: \"float-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, React.createElement(TradingViewWidget, {\n          symbol: _this3.props.match.params.name,\n          theme: Themes.LIGHT,\n          locale: \"en\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        })), React.createElement(\"h4\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115\n          },\n          __self: this\n        }, \" Stock News\"), React.createElement(\"div\", {\n          id: \"news\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116\n          },\n          __self: this\n        }));\n      });\n    }\n  }, {\n    key: \"handleUp\",\n    value: function handleUp(e) {\n      e.preventDefault();\n      this.handleSubmit('Up');\n      console.log('Up');\n    }\n  }, {\n    key: \"handleDown\",\n    value: function handleDown(e) {\n      e.preventDefault();\n      this.handleSubmit('Down');\n      console.log('Down');\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function handleSubmit(dir) {\n      var _this4 = this;\n\n      //e.preventDefault();\n      var stock = this.props.match.params.name;\n      var tokens = document.getElementById('tokens').value;\n\n      if (tokens !== \"\" && this.state.balance - tokens >= 0) {\n        console.log(this.props.firebase.auth.O);\n        var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O);\n        userDoc.set({\n          balance: this.state.balance - tokens\n        }, {\n          merge: true\n        }); //TODO: bets collection\n\n        this.props.firebase.db.collection(\"Bets\").add({\n          userDoc: userDoc,\n          stockId: stock,\n          direction: dir,\n          username: this.state.username,\n          bet: tokens\n        });\n      }\n\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).get().then(function (data) {\n        _this4.setState({\n          data: data\n        });\n\n        console.log(data.data().balance);\n\n        _this4.setState({\n          balance: data.data().balance\n        });\n      });\n    }\n  }, {\n    key: \"getBadgeClasses\",\n    value: function getBadgeClasses() {\n      var classes = \"badge m-2 badge-\";\n      classes += this.state.balance === 0 ? \"warning\" : \"primary\";\n      return classes;\n    }\n  }, {\n    key: \"formatNumberOfTokensLeft\",\n    value: function formatNumberOfTokensLeft() {\n      var balance = this.state.balance;\n      return balance === 0 ? \"Zero\" : balance;\n    }\n  }, {\n    key: \"viewNews\",\n    value: function viewNews() {\n      document.getElementById('news').innerHTML = '';\n      var stock = this.props.match.params.name;\n      var url = 'https://newsapi.org/v2/everything?q=' + stock + '&apiKey=34c665fbab834d7c80356f0bf458b1a7';\n      fetch(url).then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        console.log(data);\n\n        for (var i = 0; i < 12; i++) {\n          var title = data.articles[i].title;\n\n          if (title == null) {\n            title = \"\";\n          }\n\n          var desc = data.articles[i].description;\n          var auth = data.articles[i].author;\n          var link = data.articles[i].url;\n          var link1 = data.articles[i].urlToImage;\n          var date = data.articles[i].publishedAt;\n          document.getElementById('news').innerHTML += '<div class=\"item\"><h2 class=\"header\">' + title + '</h2>' + //character of escape: \"quotes\" and '+'\n          '<img src=\"' + link1 + '\">' + '<p class=\"publishedAt\">' + date + '</p>' + '<p>' + desc + '</p>' + '<p>' + auth + '</p>' + //character of escape: \"quotes\" and '+'\n          '<a href=\"' + link + '\">Read more</a></div>';\n        }\n      });\n    }\n  }]);\n\n  return Stocks;\n}(Component);\n\nvar condition = function condition(authUser) {\n  return !!authUser;\n};\n\nexport default withAuthorization(condition)(Stocks);","map":{"version":3,"sources":["/Users/yash/instinctiv/instinctiv/src/components/Stocks/index.js"],"names":["React","Component","AuthUserContext","withAuthorization","Input","Button","Col","Row","Card","CardText","Alert","TradingViewWidget","Themes","Stocks","props","state","username","balance","stock","match","params","name","firebase","db","collection","doc","auth","O","onSnapshot","docSnapshot","console","log","data","setState","err","address","ceo","companyURL","description","employees","price","stockExchange","ticker","time_updated","viewNews","authUser","handleUp","bind","handleDown","getBadgeClasses","formatNumberOfTokensLeft","LIGHT","e","preventDefault","handleSubmit","dir","tokens","document","getElementById","value","userDoc","set","merge","add","stockId","direction","bet","get","then","classes","innerHTML","url","fetch","response","json","i","title","articles","desc","author","link","link1","urlToImage","date","publishedAt","condition"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { AuthUserContext, withAuthorization } from '../Session';\nimport { Input, Button, Col, Row, Card, CardText, Alert } from 'reactstrap';\nimport './stocks.css';\nimport TradingViewWidget, { Themes } from 'react-tradingview-widget'\n\nclass Stocks extends Component {\n\n  constructor(props){\n    super(props);\n    this.state = {\n      username: '',\n      balance: '',\n      stock: this.props.match.params.name,\n    }\n    //this.handleChange = this.handleChange.bind(this);\n    //this.handleSubmitStock = this.handleSubmitStock.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).onSnapshot(docSnapshot => {\n      console.log(`Received doc snapshot: docSnapshot`, docSnapshot.data());\n      this.setState({\n        balance: docSnapshot.data().balance,\n        username: docSnapshot.data().username,\n        stock: this.props.match.params.name\n      });      // ...\n    }, err => {\n      console.log(`Encountered error: ${err}`);\n    });\n\n    this.props.firebase.db.collection(\"Stocks\").doc(this.props.match.params.name).onSnapshot(docSnapshot => {\n      console.log(`Received doc snapshot: docSnapshot`, docSnapshot.data());\n      this.setState({\n        balance: this.state.balance,\n        username: this.state.username,\n        address: docSnapshot.data().address,\n        ceo: docSnapshot.data().ceo,\n        companyURL: docSnapshot.data().companyURL,\n        description: docSnapshot.data().description,\n        employees: docSnapshot.data().employees,\n        name: docSnapshot.data().name,\n        price: docSnapshot.data().price,\n        stockExchange: docSnapshot.data().stockExchange,\n        ticker: docSnapshot.data().ticker,\n        time_updated: docSnapshot.data().time_updated,\n      });      // ...\n    }, err => {\n      console.log(`Encountered error: ${err}`);\n    });\n    this.viewNews();\n  }\n\n  render() {\n    return (\n      <AuthUserContext.Consumer>\n      {authUser => (\n        <div>\n          <div className=\"column small-centered small-11 medium-6 large-5\">\n          <h1>{this.props.match.params.name}</h1>\n          <Card body outline color=\"primary\">\n              <CardText>\n                  <Alert color=\"primary\">\n                    <strong>name: {this.state.name}</strong>\n                  </Alert>\n                  <Alert color=\"info\">\n                    <strong>address: {this.state.address}</strong>\n                  </Alert>\n                  <Alert color=\"info\">\n                    <strong>ceo: {this.state.ceo}</strong>\n                  </Alert>\n                  <Alert color=\"info\">\n                    <strong>companyURL: {this.state.companyURL}</strong>\n                  </Alert>\n                  <Alert color=\"info\">\n                    <strong>description: {this.state.description}</strong>\n                  </Alert>\n                  <Alert color=\"info\">\n                    <strong>employees: {this.state.employees}</strong>\n                  </Alert>\n                  <Alert color=\"info\">\n                    <strong>stockExchange: {this.state.stockExchange}</strong>\n                  </Alert>\n                  <Alert color=\"warning\">\n                    <strong>price: {this.state.price}</strong>\n                  </Alert>\n                  <Alert color=\"success\">\n                    <strong>time_updated: {this.state.time_updated}</strong>\n                  </Alert>\n              </CardText>\n            </Card>\n\n          <Row>\n              <Col sm=\"6\">\n                <Input type=\"number\" name=\"tokens\" id=\"tokens\" placeholder=\"Enter a amount to bet\"/>\n              </Col>\n              <Col sm=\"2\">\n                <Button color = \"success\" id=\"up\" onClick={this.handleUp.bind(this)} type=\"submit\"> Up </Button>\n              </Col>\n              <Col sm=\"2\">\n                <Button color = \"secondary\" id=\"down\" onClick={this.handleDown.bind(this)} type=\"submit\"> Down </Button>\n              </Col>\n          </Row>\n          \n\n          <h3>You currently have</h3>\n          <span className={this.getBadgeClasses()}>\n            {this.formatNumberOfTokensLeft()}\n          </span>\n          <h6> number of tokens.</h6>\n          </div>\n          <div className=\"float-center\">\n            <TradingViewWidget symbol={this.props.match.params.name} theme={Themes.LIGHT} locale=\"en\"/>\n          </div>\n          <h4> Stock News</h4>\n          <div id=\"news\"></div>{/* <Button outline color=\"primary\" onClick={this.viewNews} block>Search</Button> */}\n\n        </div>\n\n      )}\n      </AuthUserContext.Consumer>\n    );\n  }\n\n  handleUp(e){\n    e.preventDefault();\n    this.handleSubmit('Up');\n    console.log('Up');\n  }\n\n  handleDown(e){\n    e.preventDefault();\n    this.handleSubmit('Down');\n    console.log('Down');\n  }\n\n  handleSubmit(dir) {\n\n    //e.preventDefault();\n    var stock = this.props.match.params.name;\n    var tokens = document.getElementById('tokens').value;\n    if(tokens !==  \"\" && this.state.balance-tokens  >= 0){\n      console.log(this.props.firebase.auth.O);\n      var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O);\n      userDoc.set({\n        balance: (this.state.balance-tokens)\n      }, {merge: true});\n      //TODO: bets collection\n      this.props.firebase.db.collection(\"Bets\").add({\n        userDoc: userDoc,\n        stockId: stock,\n        direction: dir,\n        username: this.state.username,\n        bet: tokens\n      });\n    }\n    this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).get().then(data => {\n        this.setState({data: data});\n        console.log(data.data().balance);\n        this.setState({\n          balance: data.data().balance,\n        })\n      }\n    )\n  }\n\n\n\n  getBadgeClasses() {\n    let classes = \"badge m-2 badge-\";\n    classes += this.state.balance === 0 ? \"warning\" : \"primary\";\n    return classes;\n  }\n\n  formatNumberOfTokensLeft() {\n    const { balance } = this.state;\n    return balance === 0 ? \"Zero\" : balance;\n  }\n\n  viewNews() {\n     document.getElementById('news').innerHTML ='';\n     var stock = this.props.match.params.name;\n     var url = 'https://newsapi.org/v2/everything?q='\n               + stock  +\n               '&apiKey=34c665fbab834d7c80356f0bf458b1a7';\n\n     fetch(url)\n       .then(response => response.json())\n       .then(data => {\n         console.log(data);\n\n       for(var i=0; i < 12; i++){\n\n         var title = data.articles[i].title;\n\n         if(title == null){\n           title =\"\";\n         }\n         var desc = data.articles[i].description;\n         var auth = data.articles[i].author;\n         var link = data.articles[i].url;\n         var link1 = data.articles[i].urlToImage;\n         var date = data.articles[i].publishedAt;\n\n\n\n\n       document.getElementById('news').innerHTML += '<div class=\"item\"><h2 class=\"header\">' + title + '</h2>' +\n                  //character of escape: \"quotes\" and '+'\n         '<img src=\"' + link1 +'\">' +\n         '<p class=\"publishedAt\">' + date + '</p>' +\n         '<p>' + desc + '</p>' +\n         '<p>' + auth + '</p>' +\n                  //character of escape: \"quotes\" and '+'\n         '<a href=\"'+ link +'\">Read more</a></div>'\n         ;\n\n     }\n     });\n\n   }\n\n}\n\n\n\nconst condition = authUser => !!authUser;\n\nexport default withAuthorization(condition)(Stocks);\n"]},"metadata":{},"sourceType":"module"}