{"ast":null,"code":"import _classCallCheck from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/yash/instinctiv/instinctiv/src/components/Stocks/index.js\";\nimport React, { Component } from \"react\";\nimport { AuthUserContext, withAuthorization } from '../Session';\nimport { Input, Button, Col, Row, Label, Card, Alert, CardText, Table } from 'reactstrap';\nimport './stocks.css';\nimport TradingViewWidget, { Themes } from 'react-tradingview-widget'; //import { Timestamp } from \"@google-cloud/firestore\";\n\nvar Stocks =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Stocks, _Component);\n\n  function Stocks(props) {\n    var _this;\n\n    _classCallCheck(this, Stocks);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Stocks).call(this, props));\n    _this.user = null;\n    _this.state = {\n      username: '',\n      balance: '',\n      stock: _this.props.match.params.name //this.handleChange = this.handleChange.bind(this);\n      //this.handleSubmitStock = this.handleSubmitStock.bind(this);\n\n    };\n    return _this;\n  }\n\n  _createClass(Stocks, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.user = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).onSnapshot(function (docSnapshot) {\n        console.log(\"Received doc snapshot: docSnapshot\", docSnapshot.data());\n\n        _this2.setState({\n          balance: docSnapshot.data().balance,\n          username: docSnapshot.data().username,\n          stock: _this2.props.match.params.name\n        }); // ...\n\n      }, function (err) {\n        console.log(\"Encountered error: \".concat(err));\n      });\n      this.bets = this.props.firebase.db.collection(\"Bets\").where('stockId', '==', this.props.match.params.name).onSnapshot(function (querySnapshot) {\n        console.log(\"Received query snapshot of size \".concat(querySnapshot.size));\n        document.getElementById(\"bodyBets\").innerHTML = \"\";\n        querySnapshot.forEach(function (element) {\n          _this2.renderBets(element, element.id); //element.data().id = element.id;\n          //this.state.betsList.push(element.data());\n\n        });\n        console.log(querySnapshot, _this2.state.betsList);\n      }, function (err) {\n        console.log(\"Encountered error: \".concat(err));\n      });\n      this.props.firebase.db.collection(\"Stocks\").doc(this.props.match.params.name).onSnapshot(function (docSnapshot) {\n        console.log(\"Received doc snapshot: docSnapshot\", docSnapshot.data());\n\n        _this2.setState({\n          balance: _this2.state.balance,\n          username: _this2.state.username,\n          address: docSnapshot.data().address,\n          ceo: docSnapshot.data().ceo,\n          companyURL: docSnapshot.data().companyURL,\n          description: docSnapshot.data().description,\n          employees: docSnapshot.data().employees,\n          name: docSnapshot.data().name,\n          price: docSnapshot.data().price,\n          stockExchange: docSnapshot.data().stockExchange,\n          ticker: docSnapshot.data().ticker,\n          time_updated: docSnapshot.data().time_updated\n        }); // ...\n\n      }, function (err) {\n        console.log(\"Encountered error: \".concat(err));\n      });\n      this.viewNews();\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"favorites\").doc(this.props.match.params.name).get().then(function (docSnapshot) {\n        if (docSnapshot.exists) {\n          document.getElementById('fav').innerText = 'Un-favorite';\n        }\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.user();\n      this.bets();\n    }\n  }, {\n    key: \"renderBets\",\n    value: function renderBets(bet, index) {\n      //var db = this.props.firebase.db;\n      var row = document.createElement('tr');\n      row.setAttribute('id', bet.id);\n      /* \n      var stockIdTD = document.createElement('td');\n      stockIdTD.textContent = bet.data().stockId; */\n\n      var betTD = document.createElement('td');\n      betTD.textContent = bet.data().bet;\n      var dirTD = document.createElement('td');\n      dirTD.textContent = bet.data().direction; //del.appendChild(delBut);\n      //row.appendChild(stockIdTD);\n\n      row.appendChild(betTD);\n      row.appendChild(dirTD);\n      document.getElementById(\"bodyBets\").appendChild(row);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(AuthUserContext.Consumer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, function (authUser) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, React.createElement(Row, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, React.createElement(Col, {\n          sm: \"5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, React.createElement(Card, {\n          body: true,\n          inverse: true,\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, React.createElement(CardText, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111\n          },\n          __self: this\n        }, React.createElement(Button, {\n          color: \"success\",\n          id: \"fav\",\n          onClick: _this3.handleFavorite.bind(_this3),\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, \"Favorite\"), React.createElement(Alert, {\n          color: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }, \"Name: \", _this3.state.name)), React.createElement(Alert, {\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }, \"Address: \", _this3.state.address), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        })), React.createElement(Alert, {\n          color: \"secondary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        }, \"Ceo: \", _this3.state.ceo), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        })), React.createElement(Alert, {\n          color: \"warning\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, \"CompanyURL: \", _this3.state.companyURL), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        })), React.createElement(Alert, {\n          color: \"success\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, \"Employees: \", _this3.state.employees), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        })), React.createElement(Alert, {\n          color: \"dark\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, \"StockExchange: \", _this3.state.stockExchange), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        })), React.createElement(Alert, {\n          color: \"danger\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        }, \"Price: \", _this3.state.price), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        })), React.createElement(Alert, {\n          color: \"light\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }, \"TimeUpdated: \", _this3.state.time_updated), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }))))), React.createElement(Col, {\n          sm: \"7\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }, React.createElement(\"h4\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, \"Description\"), React.createElement(Card, {\n          body: true,\n          inverse: true,\n          color: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }, React.createElement(CardText, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        }, React.createElement(Alert, {\n          color: \"warning\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, _this3.state.description), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        })))), React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, \"Bet\"), React.createElement(Input, {\n          type: \"number\",\n          name: \"tokens\",\n          id: \"tokens\",\n          placeholder: \"Enter a amount to bet\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }), React.createElement(Button, {\n          color: \"success\",\n          block: true,\n          size: \"lg\",\n          id: \"up\",\n          onClick: _this3.handleUp.bind(_this3),\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }, \" Up \"), React.createElement(Button, {\n          color: \"danger\",\n          block: true,\n          size: \"lg\",\n          id: \"down\",\n          onClick: _this3.handleDown.bind(_this3),\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, \" Down \"), React.createElement(\"h5\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, \"You currently have\", React.createElement(\"span\", {\n          className: _this3.getBadgeClasses(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, _this3.formatNumberOfTokensLeft()), \" number of tokens.\")))), React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }, React.createElement(Row, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161\n          },\n          __self: this\n        }, React.createElement(Col, {\n          sm: \"5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, React.createElement(Table, {\n          striped: true,\n          hover: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163\n          },\n          __self: this\n        }, React.createElement(\"thead\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }, React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166\n          },\n          __self: this\n        }, \"Tokens bet on \", _this3.props.match.params.name), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        }, \"Up/Down\"))), React.createElement(\"tbody\", {\n          id: \"bodyBets\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170\n          },\n          __self: this\n        }))), React.createElement(Col, {\n          sm: \"5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }, React.createElement(TradingViewWidget, {\n          symbol: _this3.props.match.params.name,\n          theme: Themes.LIGHT,\n          locale: \"en\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        })))), React.createElement(\"h4\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180\n          },\n          __self: this\n        }, \" Stock News\"), React.createElement(\"div\", {\n          id: \"news\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }));\n      });\n    }\n  }, {\n    key: \"handleUp\",\n    value: function handleUp(e) {\n      e.preventDefault();\n      this.handleSubmit('Up');\n      console.log('Up');\n    }\n  }, {\n    key: \"handleDown\",\n    value: function handleDown(e) {\n      e.preventDefault();\n      this.handleSubmit('Down');\n      console.log('Down');\n    }\n  }, {\n    key: \"handleFavorite\",\n    value: function handleFavorite(e) {\n      if (document.getElementById('fav').innerText === 'Favorite') {\n        console.log('favoriting');\n        var ticker = this.props.match.params.name;\n        var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"favorites\").doc(ticker);\n        userDoc.set({\n          Ticker: ticker,\n          price: this.state.price\n        });\n        document.getElementById('fav').innerText = 'Un-favorite';\n      } else {\n        console.log('unfavoriting');\n        var ticker = this.props.match.params.name;\n        var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"favorites\").doc(ticker).delete();\n        document.getElementById('fav').innerText = 'Favorite';\n      }\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function handleSubmit(dir) {\n      var _this4 = this;\n\n      //e.preventDefault();\n      var stock = this.props.match.params.name;\n      var tokens = document.getElementById('tokens').value;\n\n      if (tokens !== \"\" && this.state.balance - tokens >= 0) {\n        console.log(this.props.firebase.auth.O);\n        var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O);\n        userDoc.set({\n          balance: this.state.balance - tokens\n        }, {\n          merge: true\n        }); //TODO: bets collection\n\n        this.props.firebase.db.collection(\"Bets\").add({\n          userDoc: userDoc,\n          stockId: stock,\n          direction: dir,\n          username: this.state.username,\n          bet: tokens\n        });\n      }\n\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).get().then(function (data) {\n        _this4.setState({\n          data: data\n        });\n\n        console.log(data.data().balance);\n\n        _this4.setState({\n          balance: data.data().balance\n        });\n      });\n\n      if (this.state.balance < 100) {\n        this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"notifications\").where('type', '==', 'lowTokens').where(\"active\", '==', true).get().then(function (docSnapshot) {\n          if (docSnapshot.size === 0) {\n            _this4.props.firebase.db.collection(\"Users\").doc(_this4.props.firebase.auth.O).collection(\"notifications\").add({\n              message: 'You have less than 100 tokens left, go to the account section to add tokens.',\n              active: true,\n              type: 'lowTokens',\n              time: new Date()\n            });\n          }\n        }, function (err) {\n          console.log(\"Encountered error: \".concat(err));\n        });\n      }\n    }\n  }, {\n    key: \"getBadgeClasses\",\n    value: function getBadgeClasses() {\n      var classes = \"badge m-2 badge-\";\n      classes += this.state.balance === 0 ? \"warning\" : \"primary\";\n      return classes;\n    }\n  }, {\n    key: \"formatNumberOfTokensLeft\",\n    value: function formatNumberOfTokensLeft() {\n      var balance = this.state.balance;\n      return balance === 0 ? \"Zero\" : balance;\n    }\n  }, {\n    key: \"viewNews\",\n    value: function viewNews() {\n      document.getElementById('news').innerHTML = '';\n      var stock = this.props.match.params.name;\n      var url = 'https://newsapi.org/v2/everything?q=' + stock + '&apiKey=34c665fbab834d7c80356f0bf458b1a7';\n      fetch(url).then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        console.log(data);\n\n        for (var i = 0; i < 12; i++) {\n          var title = data.articles[i].title;\n\n          if (title == null) {\n            title = \"\";\n          }\n\n          var desc = data.articles[i].description;\n          var auth = data.articles[i].author;\n          var link = data.articles[i].url;\n          var link1 = data.articles[i].urlToImage;\n          var date = data.articles[i].publishedAt;\n          document.getElementById('news').innerHTML += '<div class=\"item\"><h2 class=\"header\">' + title + '</h2>' + //character of escape: \"quotes\" and '+'\n          '<img src=\"' + link1 + '\">' + '<p class=\"publishedAt\">' + date + '</p>' + '<p>' + desc + '</p>' + '<p>' + auth + '</p>' + //character of escape: \"quotes\" and '+'\n          '<a href=\"' + link + '\">Read more</a></div>';\n        }\n      });\n    }\n  }]);\n\n  return Stocks;\n}(Component);\n\nvar condition = function condition(authUser) {\n  return !!authUser;\n};\n\nexport default withAuthorization(condition)(Stocks);","map":{"version":3,"sources":["/Users/yash/instinctiv/instinctiv/src/components/Stocks/index.js"],"names":["React","Component","AuthUserContext","withAuthorization","Input","Button","Col","Row","Label","Card","Alert","CardText","Table","TradingViewWidget","Themes","Stocks","props","user","state","username","balance","stock","match","params","name","firebase","db","collection","doc","auth","O","onSnapshot","docSnapshot","console","log","data","setState","err","bets","where","querySnapshot","size","document","getElementById","innerHTML","forEach","element","renderBets","id","betsList","address","ceo","companyURL","description","employees","price","stockExchange","ticker","time_updated","viewNews","get","then","exists","innerText","bet","index","row","createElement","setAttribute","betTD","textContent","dirTD","direction","appendChild","authUser","handleFavorite","bind","handleUp","handleDown","getBadgeClasses","formatNumberOfTokensLeft","LIGHT","e","preventDefault","handleSubmit","userDoc","set","Ticker","delete","dir","tokens","value","merge","add","stockId","message","active","type","time","Date","classes","url","fetch","response","json","i","title","articles","desc","author","link","link1","urlToImage","date","publishedAt","condition"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { AuthUserContext, withAuthorization } from '../Session';\nimport { Input, Button, Col, Row, Label, Card, Alert, CardText, Table } from 'reactstrap';\nimport './stocks.css';\nimport TradingViewWidget, { Themes } from 'react-tradingview-widget'\n//import { Timestamp } from \"@google-cloud/firestore\";\n\nclass Stocks extends Component {\n\n  constructor(props){\n    super(props);\n    this.user = null;\n    this.state = {\n      username: '',\n      balance: '',\n      stock: this.props.match.params.name,\n    }\n    //this.handleChange = this.handleChange.bind(this);\n    //this.handleSubmitStock = this.handleSubmitStock.bind(this);\n  }\n\n  componentDidMount() {\n    this.user = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).onSnapshot(docSnapshot => {\n      console.log(`Received doc snapshot: docSnapshot`, docSnapshot.data());\n      this.setState({\n        balance: docSnapshot.data().balance,\n        username: docSnapshot.data().username,\n        stock: this.props.match.params.name\n      });      // ...\n    }, err => {\n      console.log(`Encountered error: ${err}`);\n    });\n\n    this.bets = this.props.firebase.db.collection(\"Bets\").where('stockId', '==', this.props.match.params.name).onSnapshot(querySnapshot => {\n      console.log(`Received query snapshot of size ${querySnapshot.size}`);\n      document.getElementById(\"bodyBets\").innerHTML = \"\";\n      querySnapshot.forEach(element => {\n          this.renderBets(element, element.id);\n        //element.data().id = element.id;\n        //this.state.betsList.push(element.data());\n      });\n      console.log(querySnapshot, this.state.betsList);\n    }, err => {\n      console.log(`Encountered error: ${err}`);\n    });\n\n    this.props.firebase.db.collection(\"Stocks\").doc(this.props.match.params.name).onSnapshot(docSnapshot => {\n      console.log(`Received doc snapshot: docSnapshot`, docSnapshot.data());\n      this.setState({\n        balance: this.state.balance,\n        username: this.state.username,\n        address: docSnapshot.data().address,\n        ceo: docSnapshot.data().ceo,\n        companyURL: docSnapshot.data().companyURL,\n        description: docSnapshot.data().description,\n        employees: docSnapshot.data().employees,\n        name: docSnapshot.data().name,\n        price: docSnapshot.data().price,\n        stockExchange: docSnapshot.data().stockExchange,\n        ticker: docSnapshot.data().ticker,\n        time_updated: docSnapshot.data().time_updated,\n      });      // ...\n    }, err => {\n      console.log(`Encountered error: ${err}`);\n    });\n    this.viewNews();\n\n    this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"favorites\").doc(this.props.match.params.name)\n      .get().then(docSnapshot => {\n        if(docSnapshot.exists){\n          document.getElementById('fav').innerText = 'Un-favorite';\n        }\n      });\n  }\n\n  componentWillUnmount(){\n    this.user();\n    this.bets();\n  }\n\n\n  renderBets(bet, index) {\n    //var db = this.props.firebase.db;\n    var row = document.createElement('tr');\n    row.setAttribute('id', bet.id);/* \n    var stockIdTD = document.createElement('td');\n    stockIdTD.textContent = bet.data().stockId; */\n    var betTD = document.createElement('td');\n    betTD.textContent = bet.data().bet;\n  \n    var dirTD = document.createElement('td');\n    dirTD.textContent = bet.data().direction;\n    //del.appendChild(delBut);\n    //row.appendChild(stockIdTD);\n    row.appendChild(betTD);\n    row.appendChild(dirTD);\n\n    document.getElementById(\"bodyBets\").appendChild(row);\n\n  }\n\n  render() {\n    return (\n      <AuthUserContext.Consumer>\n      {authUser => (\n        <div>\n          <div>\n            <Row>\n            <Col sm=\"5\">\n              <Card body inverse color=\"info\">\n        <CardText>\n            <Button color=\"success\" id=\"fav\" onClick={this.handleFavorite.bind(this)} type=\"submit\">Favorite</Button>\n            <Alert color=\"primary\">\n              <strong>Name: {this.state.name}</strong>\n            </Alert>\n            <Alert color=\"info\">\n              <strong>Address: {this.state.address}</strong><br/>\n            </Alert>\n            <Alert color=\"secondary\">\n              <strong>Ceo: {this.state.ceo}</strong><br/>\n            </Alert>\n            <Alert color=\"warning\">\n              <strong>CompanyURL: {this.state.companyURL}</strong><br/>\n            </Alert>\n            <Alert color=\"success\">\n              <strong>Employees: {this.state.employees}</strong><br/>\n            </Alert>\n            <Alert color=\"dark\">\n              <strong>StockExchange: {this.state.stockExchange}</strong><br/>\n            </Alert>\n            <Alert color=\"danger\">\n              <strong>Price: {this.state.price}</strong><br/>\n            </Alert>\n            <Alert color=\"light\">\n              <strong>TimeUpdated: {this.state.time_updated}</strong><br/>\n            </Alert>\n        </CardText>\n      </Card>\n          </Col>\n          <Col sm=\"7\">\n            <h4>Description</h4>\n            <Card body inverse color=\"info\">\n      <CardText>\n          <Alert color=\"warning\">\n            <strong>{this.state.description}</strong><br/>\n          </Alert>\n      </CardText>\n    </Card>\n    <h1>Bet</h1>\n    <Input type=\"number\" name=\"tokens\" id=\"tokens\" placeholder=\"Enter a amount to bet\"/>\n    <Button color = \"success\" block size=\"lg\" id=\"up\" onClick={this.handleUp.bind(this)} type=\"submit\"> Up </Button>\n    <Button color = \"danger\" block size=\"lg\"id=\"down\" onClick={this.handleDown.bind(this)} type=\"submit\"> Down </Button>\n\n      <h5>You currently have<span className={this.getBadgeClasses()}>\n        {this.formatNumberOfTokensLeft()}\n      </span> number of tokens.</h5>\n        </Col>\n          </Row>\n          </div>\n          <div>\n            <Row>\n              <Col sm=\"5\">\n            <Table striped hover>\n              <thead>\n                <tr>\n                  <th>Tokens bet on {this.props.match.params.name}</th>\n                  <th>Up/Down</th>\n                </tr>\n              </thead>\n              <tbody id='bodyBets'>\n\n              </tbody>\n            </Table>\n            </Col>\n            <Col sm=\"5\">\n            <TradingViewWidget symbol={this.props.match.params.name} theme={Themes.LIGHT} locale=\"en\"/>\n            </Col>\n            </Row>\n          </div>\n          <h4> Stock News</h4>\n          <div id=\"news\"></div>{/* <Button outline color=\"primary\" onClick={this.viewNews} block>Search</Button> */}\n\n        </div>\n\n      )}\n      </AuthUserContext.Consumer>\n    );\n  }\n\n  handleUp(e){\n    e.preventDefault();\n    this.handleSubmit('Up');\n    console.log('Up');\n  }\n\n  handleDown(e){\n    e.preventDefault();\n    this.handleSubmit('Down');\n    console.log('Down');\n  }\n\n  handleFavorite(e){\n\n    if(document.getElementById('fav').innerText === 'Favorite'){\n      console.log('favoriting');\n      var ticker = this.props.match.params.name;\n      var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"favorites\").doc(ticker)\n      userDoc.set({\n        Ticker: ticker,\n        price: this.state.price\n      })\n      document.getElementById('fav').innerText = 'Un-favorite';\n\n\n    }else{\n      console.log('unfavoriting');\n      var ticker = this.props.match.params.name;\n      var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"favorites\").doc(ticker).delete();\n      document.getElementById('fav').innerText = 'Favorite';\n    }\n    \n  }\n\n  handleSubmit(dir) {\n\n    //e.preventDefault();\n    var stock = this.props.match.params.name;\n    var tokens = document.getElementById('tokens').value;\n    if(tokens !==  \"\" && this.state.balance-tokens  >= 0){\n      console.log(this.props.firebase.auth.O);\n      var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O);\n      userDoc.set({\n        balance: (this.state.balance-tokens)\n      }, {merge: true});\n      //TODO: bets collection\n      this.props.firebase.db.collection(\"Bets\").add({\n        userDoc: userDoc,\n        stockId: stock,\n        direction: dir,\n        username: this.state.username,\n        bet: tokens\n      });\n    }\n    this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).get().then(data => {\n        this.setState({data: data});\n        console.log(data.data().balance);\n        this.setState({\n          balance: data.data().balance,\n        })\n      }\n    )\n    if(this.state.balance < 100){\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O)\n      .collection(\"notifications\")\n      .where('type', '==', 'lowTokens')\n            .where(\"active\", '==', true).get().then(docSnapshot => {\n                if(docSnapshot.size===0){\n                this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).collection(\"notifications\").add({\n                  message: 'You have less than 100 tokens left, go to the account section to add tokens.',\n                  active: true,\n                  type: 'lowTokens',\n                  time: new Date(),\n                });\n              }\n              }, err => {\n                console.log(`Encountered error: ${err}`);\n              });\n\n    }\n  }\n\n\n\n  getBadgeClasses() {\n    let classes = \"badge m-2 badge-\";\n    classes += this.state.balance === 0 ? \"warning\" : \"primary\";\n    return classes;\n  }\n\n  formatNumberOfTokensLeft() {\n    const { balance } = this.state;\n    return balance === 0 ? \"Zero\" : balance;\n  }\n\n  viewNews() {\n     document.getElementById('news').innerHTML ='';\n     var stock = this.props.match.params.name;\n     var url = 'https://newsapi.org/v2/everything?q='\n               + stock  +\n               '&apiKey=34c665fbab834d7c80356f0bf458b1a7';\n\n     fetch(url)\n       .then(response => response.json())\n       .then(data => {\n         console.log(data);\n\n       for(var i=0; i < 12; i++){\n\n         var title = data.articles[i].title;\n\n         if(title == null){\n           title =\"\";\n         }\n         var desc = data.articles[i].description;\n         var auth = data.articles[i].author;\n         var link = data.articles[i].url;\n         var link1 = data.articles[i].urlToImage;\n         var date = data.articles[i].publishedAt;\n\n\n\n\n       document.getElementById('news').innerHTML += '<div class=\"item\"><h2 class=\"header\">' + title + '</h2>' +\n                  //character of escape: \"quotes\" and '+'\n         '<img src=\"' + link1 +'\">' +\n         '<p class=\"publishedAt\">' + date + '</p>' +\n         '<p>' + desc + '</p>' +\n         '<p>' + auth + '</p>' +\n                  //character of escape: \"quotes\" and '+'\n         '<a href=\"'+ link +'\">Read more</a></div>'\n         ;\n\n     }\n     });\n\n   }\n\n}\n\n\n\nconst condition = authUser => !!authUser;\n\nexport default withAuthorization(condition)(Stocks);\n"]},"metadata":{},"sourceType":"module"}