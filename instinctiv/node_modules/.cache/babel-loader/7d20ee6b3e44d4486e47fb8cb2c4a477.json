{"ast":null,"code":"import _classCallCheck from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/yash/instinctiv/instinctiv/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/yash/instinctiv/instinctiv/src/components/Stocks/index.js\";\nimport React, { Component } from \"react\";\nimport { AuthUserContext, withAuthorization } from '../Session';\nimport { Input, Button } from 'reactstrap';\nimport './stocks.css';\nimport TradingViewWidget, { Themes } from 'react-tradingview-widget';\nstock = \"AAPL\";\n\nvar Stocks =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Stocks, _Component);\n\n  function Stocks(props) {\n    var _this;\n\n    _classCallCheck(this, Stocks);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Stocks).call(this, props));\n    _this.state = {\n      authUser: null,\n      balance: '' //this.handleChange = this.handleChange.bind(this);\n      //this.handleSubmitStock = this.handleSubmitStock.bind(this);\n\n    };\n    return _this;\n  }\n\n  _createClass(Stocks, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).onSnapshot(function (docSnapshot) {\n        console.log(\"Received doc snapshot: docSnapshot\", docSnapshot.data());\n\n        _this2.setState({\n          balance: docSnapshot.data().balance,\n          username: docSnapshot.data().username\n        }); // ...\n\n      }, function (err) {\n        console.log(\"Encountered error: \".concat(err));\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(AuthUserContext.Consumer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 36\n        },\n        __self: this\n      }, function (authUser) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 38\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 39\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"column small-centered small-11 medium-6 large-5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 40\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 41\n          },\n          __self: this\n        }, \"Stocks\"), React.createElement(Input, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 42\n          },\n          __self: this\n        }, \"Search Stocks\"), React.createElement(\"form\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 43\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 44\n          },\n          __self: this\n        }, \"Tokens to Bet:\", React.createElement(Input, {\n          type: \"number\",\n          name: \"tokens\",\n          id: \"tokens\",\n          placeholder: \"Enter a amount to bet\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 46\n          },\n          __self: this\n        }), React.createElement(Button, {\n          color: \"success\",\n          id: \"up\",\n          onClick: _this3.handleUp.bind(_this3),\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 47\n          },\n          __self: this\n        }, \" Up \"), React.createElement(Button, {\n          color: \"secondary\",\n          id: \"down\",\n          onClick: _this3.handleDown.bind(_this3),\n          type: \"submit\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 48\n          },\n          __self: this\n        }, \" Down \"))), React.createElement(\"h3\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 52\n          },\n          __self: this\n        }, \"You currently have\"), React.createElement(\"span\", {\n          className: _this3.getBadgeClasses(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 53\n          },\n          __self: this\n        }, _this3.formatnumberOfTokensLeft()), React.createElement(\"h9\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 56\n          },\n          __self: this\n        }, \" number of tokens.\"), React.createElement(\"h9\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 57\n          },\n          __self: this\n        }, \" \"), React.createElement(\"h4\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 58\n          },\n          __self: this\n        }, \" Search Stock News\"), React.createElement(\"input\", {\n          type: \"text\",\n          id: \"compName\",\n          placeholder: \"Company Name\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 60\n          },\n          __self: this\n        }), React.createElement(Button, {\n          outline: true,\n          color: \"primary\",\n          onClick: _this3.viewNews,\n          block: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 62\n          },\n          __self: this\n        }, \"Search\")), React.createElement(\"div\", {\n          className: \"float-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        }, React.createElement(TradingViewWidget, {\n          symbol: stock,\n          theme: Themes.LIGHT,\n          locale: \"en\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 65\n          },\n          __self: this\n        }))), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 73\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          id: \"news\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 74\n          },\n          __self: this\n        }));\n      });\n    }\n  }, {\n    key: \"handleUp\",\n    value: function handleUp(e) {\n      e.preventDefault();\n      this.handleSubmit('Up');\n      console.log('Up');\n    }\n  }, {\n    key: \"handleDown\",\n    value: function handleDown(e) {\n      e.preventDefault();\n      this.handleSubmit('Down');\n      console.log('Down');\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function handleSubmit(dir) {\n      var _this4 = this;\n\n      //e.preventDefault();\n      var stock = document.getElementById('stock').value;\n      var tokens = document.getElementById('tokens').value;\n\n      if (tokens != \"\" && this.state.balance - tokens >= 0) {\n        console.log(this.props.firebase.auth.O);\n        var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O);\n        userDoc.set({\n          balance: this.state.balance - tokens\n        }, {\n          merge: true\n        }); //TODO: bets collection\n\n        this.props.firebase.db.collection(\"Bets\").add({\n          userDoc: userDoc,\n          stockId: stock,\n          direction: dir,\n          bet: tokens\n        });\n      }\n\n      this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).get().then(function (data) {\n        _this4.setState({\n          data: data\n        });\n\n        console.log(data.data().balance);\n\n        _this4.setState({\n          balance: data.data().balance\n        });\n      });\n    }\n  }, {\n    key: \"getBadgeClasses\",\n    value: function getBadgeClasses() {\n      var classes = \"badge m-2 badge-\";\n      classes += this.state.balance === 0 ? \"warning\" : \"primary\";\n      return classes;\n    }\n  }, {\n    key: \"formatnumberOfTokensLeft\",\n    value: function formatnumberOfTokensLeft() {\n      var balance = this.state.balance;\n      return balance === 0 ? \"Zero\" : balance;\n    }\n  }, {\n    key: \"viewNews\",\n    value: function viewNews() {\n      document.getElementById('news').innerHTML = '';\n      var stock = document.getElementById(\"compName\").value;\n      var url = 'https://newsapi.org/v2/everything?q=' + stock + '&apiKey=34c665fbab834d7c80356f0bf458b1a7';\n      fetch(url).then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        console.log(data);\n\n        for (var i = 0; i < 12; i++) {\n          var title = data.articles[i].title;\n\n          if (title == null) {\n            title = \"\";\n          }\n\n          var desc = data.articles[i].description;\n          var auth = data.articles[i].author;\n          var link = data.articles[i].url;\n          var link1 = data.articles[i].urlToImage;\n          var date = data.articles[i].publishedAt;\n          document.getElementById('news').innerHTML += '<div class=\"item\"><h2 class=\"header\">' + title + '</h2>' + //character of escape: \"quotes\" and '+'\n          '<img src=\"' + link1 + '\">' + '<p class=\"publishedAt\">' + date + '</p>' + '<p>' + desc + '</p>' + '<p>' + auth + '</p>' + //character of escape: \"quotes\" and '+'\n          '<a href=\"' + link + '\">Read more</a></div>';\n        }\n      });\n    }\n  }]);\n\n  return Stocks;\n}(Component);\n\nvar condition = function condition(authUser) {\n  return !!authUser;\n};\n\nexport default withAuthorization(condition)(Stocks);","map":{"version":3,"sources":["/Users/yash/instinctiv/instinctiv/src/components/Stocks/index.js"],"names":["React","Component","AuthUserContext","withAuthorization","Input","Button","TradingViewWidget","Themes","stock","Stocks","props","state","authUser","balance","firebase","db","collection","doc","auth","O","onSnapshot","docSnapshot","console","log","data","setState","username","err","handleUp","bind","handleDown","getBadgeClasses","formatnumberOfTokensLeft","viewNews","LIGHT","e","preventDefault","handleSubmit","dir","document","getElementById","value","tokens","userDoc","set","merge","add","stockId","direction","bet","get","then","classes","innerHTML","url","fetch","response","json","i","title","articles","desc","description","author","link","link1","urlToImage","date","publishedAt","condition"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { AuthUserContext, withAuthorization } from '../Session';\nimport { Input, Button } from 'reactstrap';\nimport './stocks.css';\nimport TradingViewWidget, { Themes } from 'react-tradingview-widget'\n\nstock = \"AAPL\";\n\nclass Stocks extends Component {\n\n  constructor(props){\n    super(props);\n    this.state = {\n      authUser: null,\n      balance: '',\n\n    }\n    //this.handleChange = this.handleChange.bind(this);\n    //this.handleSubmitStock = this.handleSubmitStock.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).onSnapshot(docSnapshot => {\n      console.log(`Received doc snapshot: docSnapshot`, docSnapshot.data());\n      this.setState({\n        balance: docSnapshot.data().balance,\n        username: docSnapshot.data().username\n      });      // ...\n    }, err => {\n      console.log(`Encountered error: ${err}`);\n    });\n  }\n\n  render() {\n    return (\n      <AuthUserContext.Consumer>\n      {authUser => (\n        <div>\n          <div className=\"row\">\n              <div className=\"column small-centered small-11 medium-6 large-5\">\n          <h1>Stocks</h1>\n          <Input>Search Stocks</Input>\n          <form>\n            <label>\n              Tokens to Bet:\n              <Input type=\"number\" name=\"tokens\" id=\"tokens\" placeholder=\"Enter a amount to bet\"/>\n              <Button color = \"success\" id=\"up\" onClick={this.handleUp.bind(this)} type=\"submit\"> Up </Button>\n              <Button color = \"secondary\" id=\"down\" onClick={this.handleDown.bind(this)} type=\"submit\"> Down </Button>\n            </label>\n          </form>\n\n          <h3>You currently have</h3>\n          <span className={this.getBadgeClasses()}>\n            {this.formatnumberOfTokensLeft()}\n          </span>\n          <h9> number of tokens.</h9>\n          <h9> </h9>\n          <h4> Search Stock News</h4>\n\n          <input type=\"text\" id=\"compName\" placeholder=\"Company Name\"></input>\n\n          <Button outline color=\"primary\" onClick={this.viewNews} block>Search</Button>\n          </div>\n          <div className=\"float-center\">\n              <TradingViewWidget\n                symbol={stock}\n                theme={Themes.LIGHT}\n                locale=\"en\"\n              />\n\n            </div>\n        </div>\n        <br></br>\n        <div id=\"news\"></div>\n\n        </div>\n\n      )}\n      </AuthUserContext.Consumer>\n    );\n  }\n\n  handleUp(e){\n    e.preventDefault();\n    this.handleSubmit('Up');\n    console.log('Up');\n  }\n\n  handleDown(e){\n    e.preventDefault();\n    this.handleSubmit('Down');\n    console.log('Down');\n  }\n\n  handleSubmit(dir) {\n\n    //e.preventDefault();\n    var stock = document.getElementById('stock').value;\n    var tokens = document.getElementById('tokens').value;\n    if(tokens !=  \"\" && this.state.balance-tokens  >= 0){\n      console.log(this.props.firebase.auth.O);\n      var userDoc = this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O);\n      userDoc.set({\n        balance: (this.state.balance-tokens)\n      }, {merge: true});\n      //TODO: bets collection\n      this.props.firebase.db.collection(\"Bets\").add({\n        userDoc: userDoc,\n        stockId: stock,\n        direction: dir,\n        bet: tokens\n      });\n    }\n    this.props.firebase.db.collection(\"Users\").doc(this.props.firebase.auth.O).get().then(data => {\n        this.setState({data: data});\n        console.log(data.data().balance);\n        this.setState({\n          balance: data.data().balance,\n        })\n      }\n    )\n  }\n\n\n\n  getBadgeClasses() {\n    let classes = \"badge m-2 badge-\";\n    classes += this.state.balance === 0 ? \"warning\" : \"primary\";\n    return classes;\n  }\n\n  formatnumberOfTokensLeft() {\n    const { balance } = this.state;\n    return balance === 0 ? \"Zero\" : balance;\n  }\n\n  viewNews() {\n     document.getElementById('news').innerHTML ='';\n     var stock = document.getElementById(\"compName\").value;\n     var url = 'https://newsapi.org/v2/everything?q='\n               + stock  +\n               '&apiKey=34c665fbab834d7c80356f0bf458b1a7';\n\n     fetch(url)\n       .then(response => response.json())\n       .then(data => {\n         console.log(data);\n\n       for(var i=0; i < 12; i++){\n\n         var title = data.articles[i].title;\n\n         if(title == null){\n           title =\"\";\n         }\n         var desc = data.articles[i].description;\n         var auth = data.articles[i].author;\n         var link = data.articles[i].url;\n         var link1 = data.articles[i].urlToImage;\n         var date = data.articles[i].publishedAt;\n\n\n\n\n       document.getElementById('news').innerHTML += '<div class=\"item\"><h2 class=\"header\">' + title + '</h2>' +\n                  //character of escape: \"quotes\" and '+'\n         '<img src=\"' + link1 +'\">' +\n         '<p class=\"publishedAt\">' + date + '</p>' +\n         '<p>' + desc + '</p>' +\n         '<p>' + auth + '</p>' +\n                  //character of escape: \"quotes\" and '+'\n         '<a href=\"'+ link +'\">Read more</a></div>'\n         ;\n\n     }\n     });\n\n   }\n\n}\n\n\n\nconst condition = authUser => !!authUser;\n\nexport default withAuthorization(condition)(Stocks);\n"]},"metadata":{},"sourceType":"module"}